@model VirtualGlassesProvider.Models.DTOs.GlassesDTO
@{
    ViewData["Title"] = "Details";
}

@{
    var addedToCartMessage = TempData["AddedToCartMessage"] as string;
}
@if (!string.IsNullOrEmpty(addedToCartMessage))
{
    <div id="addedToCartMessage" class="alert alert-success" role="alert">
        @addedToCartMessage
    </div>
}
<div id="detailsLeft">
    <hr />
        <h1>
            @Html.DisplayFor(model => model.BrandName)
            @Html.DisplayFor(model => model.Colour)
            @Html.DisplayFor(model => model.Style)
        </h1>
        <div id="productDisplayImageDetailsDiv">
            <div id="imgRender">
                <img class="detailsImage" id="detailsImage" src="/@Html.DisplayFor(model => model.Image)" alt="@Html.DisplayFor(model => model.BrandName)" />
                <p class="errorMessage" id="errorMessage"></p>
            </div>
        </div>
        <br />
        <a id="clearImage" class="btn btn-primary">Clear Image</a>
        &nbsp;
        <a class="btn btn-primary" id="downloadImageLink">Download Image</a>
        <br />
        <br />
        <br />
        <br />
        <p>
            <b>@Html.DisplayNameFor(model => model.Price)</b>
        </p>
        <p>
            <b>@Html.DisplayFor(model => model.Price)</b>
        </p>
        <a asp-action="Index">Back to List</a>
</div>

<div id="detailsRight">
    <div>
        <h2>
            @Html.DisplayNameFor(model => model.Description)
        </h2>
        <p>
            @Html.DisplayFor(model => model.Description)
        </p>
        </div>
    <div id="detailsFormsDiv">
        <form id="formCart" action="@Url.Action("AddToCart", "Home")" method="get">
            <label for="size">Size:</label>
            <br />
            <select id="size" name="size">
                <option value="S">S</option>
                <option value="M">M</option>
                <option value="L">L</option>
                <option value="XL">XL</option>
            </select>
            <br />
            <br />
            <input type="hidden" name="id" value="@Model.ID" />
            <input type="hidden" name="qty" value="1" />
            <input type="hidden" name="source" value="details" />
            <input type="submit" id="addProductToCartBtn" name="addProductToCartBtn" value="Add to Cart" aria-label="add to cart button" class="btn btn-primary" />
        </form>

        <form id="formAR">
            <label for="buyFor">Buy For:</label>
            <br />
            <select id="buyFor" name="buyFor">
                <option value="self">Self</option>
                @if (ViewBag.Members != null)
                {
                    @foreach (var member in ViewBag.Members)
                    {
                        <option value="@member.ID">@member.Name</option>
                    }
                }
            </select>
            <br />
            <br />
            <label for="backgroundAR">AR Background:</label>
            <br />
            <select id="backgroundAR" name="backgroundAR">
                <option value="beach">Beach</option>
                <option value="office">Office</option>
                <!--ToDo: Populate with more options-->
            </select>
            <br />
            <br />

            <input type="button" id="generateImageBtn" name="generateImageBtn" value="Try on virtually" aria-label="generate AR image button" class="btn btn-dark" />
            &nbsp; &nbsp;
            <input type="button" id="ApplyGlassesFilterBtn" name="ApplyGlassesFilterBtn" value="Live Try On!" aria-label="generate live try on button" class="btn btn-dark" />
            @* <a asp-action="ApplyGlassesFilter" asp-controller="Home" class="btn btn-primary">Live Try On!</a> *@
            <canvas id="canvasOutput" hidden></canvas>
            <img id="originalPortrait" src="" hidden />
            <img id="productImage" src="~/@Html.DisplayFor(model => model.Image)" hidden />
            <p id="glassesBrandNameVal" hidden>@Html.DisplayFor(model => model.BrandName)</p>
        </form>  
        
    </div>
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
<script src="~/js/details.js" asp-append-version="true"></script>

<script>
    setTimeout(function () {
        var addedToCartMessageElement = document.getElementById('addedToCartMessage');
        if (addedToCartMessageElement) {
            addedToCartMessageElement.remove();
        }
    }, 2000);
</script>



